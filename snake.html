<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arnav Verse | Neon Snake</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #050505; color: #fff;
            font-family: 'Rajdhani', sans-serif;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100vh; margin: 0; overflow: hidden;
            background-image: radial-gradient(circle at center, #111 0%, #000 100%);
            touch-action: none;
        }

        /* --- BOT PROFILE --- */
        .opponent-area {
            display: flex; align-items: center; gap: 20px; margin-bottom: 15px;
            width: 380px; padding: 10px;
            background: rgba(20, 20, 20, 0.8); border: 1px solid #333;
            border-left: 4px solid #00ff88; border-radius: 0 10px 10px 0;
            backdrop-filter: blur(5px);
        }
        .bot-avatar {
            width: 50px; height: 50px; border-radius: 10px; background: #000;
            border: 2px solid #00ff88; display: flex; align-items: center; justify-content: center;
            font-size: 25px; color: #00ff88; box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        .bot-info h3 { margin: 0; font-size: 1.1rem; color: #fff; text-transform: uppercase; }
        .score-box { font-size: 0.9rem; color: #888; }
        .highlight { color: #00ff88; font-weight: bold; }
        .speech-bubble {
            margin-top: 5px; font-size: 0.8rem; color: #00ff88; font-style: italic; min-height: 20px;
        }

        /* --- SPEED SELECTOR --- */
        .speed-control {
            margin-bottom: 10px;
            display: flex; gap: 10px; align-items: center;
            font-size: 0.9rem; color: #aaa;
        }
        select {
            background: #111; color: #00a3ff; border: 1px solid #333;
            padding: 5px 10px; border-radius: 5px; font-family: 'Orbitron', sans-serif;
            cursor: pointer; outline: none;
        }
        select:hover { border-color: #00a3ff; }

        /* --- GAME BOARD --- */
        canvas {
            background: #080808;
            border: 3px solid #333;
            box-shadow: 0 0 40px rgba(0, 255, 136, 0.1);
            display: block; border-radius: 5px;
        }

        /* --- CONTROLS --- */
        .controls { margin-top: 20px; display: flex; gap: 15px; }
        .btn {
            background: transparent; border: 1px solid #00a3ff; color: #00a3ff;
            padding: 8px 25px; cursor: pointer; text-transform: uppercase; font-weight: bold;
            text-decoration: none; transition: 0.3s; font-family: 'Orbitron', sans-serif; font-size: 0.8rem;
        }
        .btn:hover { background: #00a3ff; color: #000; box-shadow: 0 0 15px #00a3ff; }
        .btn-exit { border-color: #ff4b4b; color: #ff4b4b; }
        .btn-exit:hover { background: #ff4b4b; color: #fff; box-shadow: 0 0 15px #ff4b4b; }

        /* Mobile D-Pad */
        .mobile-controls {
            display: none; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-top: 15px;
        }
        .d-btn {
            width: 50px; height: 50px; background: rgba(255,255,255,0.1); border: 1px solid #333;
            color: #fff; border-radius: 5px; font-size: 1.2rem; cursor: pointer;
        }
        .d-btn:active { background: #00ff88; color: #000; }

        @media (max-width: 600px) {
            canvas { width: 340px; height: 340px; }
            .mobile-controls { display: grid; }
            .opponent-area { width: 340px; }
        }
    </style>
</head>
<body>

    <div class="opponent-area">
        <div class="bot-avatar"><i class="fas fa-robot"></i></div>
        <div class="bot-info">
            <h3>Arnav's Bot</h3>
            <div class="score-box">SCORE: <span id="score" class="highlight">0</span> | HIGH: <span id="high-score">0</span></div>
            <div class="speech-bubble" id="bot-msg">"Ready to feed the beast? üêç"</div>
        </div>
    </div>

    <div class="speed-control">
        <span>DIFFICULTY:</span>
        <select id="speedSelect">
            <option value="150">NOOB (Slow)</option>
            <option value="90" selected>PRO (Normal)</option>
            <option value="50">HACKER (Fast)</option>
        </select>
    </div>

    <canvas id="gameCanvas" width="400" height="400"></canvas>

    <div class="mobile-controls">
        <div></div>
        <button class="d-btn" onclick="changeDirection('UP')"><i class="fas fa-arrow-up"></i></button>
        <div></div>
        <button class="d-btn" onclick="changeDirection('LEFT')"><i class="fas fa-arrow-left"></i></button>
        <button class="d-btn" onclick="changeDirection('DOWN')"><i class="fas fa-arrow-down"></i></button>
        <button class="d-btn" onclick="changeDirection('RIGHT')"><i class="fas fa-arrow-right"></i></button>
    </div>

    <div class="controls">
        <a href="verse.html" class="btn btn-exit">Exit</a>
        <button class="btn" onclick="resetGame()">Start Game</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const box = 20; // Size of one square
        const canvasSize = 400;

        let snake = [];
        let food = {};
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        document.getElementById('high-score').innerText = highScore;

        let d; // Direction
        let game; // Interval
        let isGameRunning = false;
        let foodPulse = 0; // Animation var

        // --- AUDIO ENGINE ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            if (type === 'eat') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(440, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
            } else if (type === 'die') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
            }
            
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + (type==='eat'?0.1:0.3));
            osc.start(); osc.stop(audioCtx.currentTime + (type==='eat'?0.1:0.3));
        }

        // --- DIALOGUES ---
        const dialogues = {
            start: ["Focus mode on.", "Don't hit the wall.", "Let's go!"],
            eat: ["Yummy. üçé", "Bigger!", "Nice move.", "Feed me!"],
            die: ["Ouch! üíÄ", "Wall tasty thi?", "Game Over bro.", "Skill issue."],
            highScore: ["New High Score! üî•", "Legendary!", "Hacker mode?"]
        };

        function speak(category) {
            const msgs = dialogues[category];
            const msg = msgs[Math.floor(Math.random() * msgs.length)];
            const el = document.getElementById('bot-msg');
            el.style.opacity = 0;
            setTimeout(() => { el.innerText = msg; el.style.opacity = 1; 
                if(category === 'die') el.style.color = '#ff4b4b';
                else if(category === 'eat') el.style.color = '#00ff88';
                else el.style.color = '#00a3ff';
            }, 100);
        }

        // --- CONTROLS ---
        document.addEventListener('keydown', direction);

        function direction(event) {
            if(event.keyCode == 37 && d != "RIGHT") d = "LEFT";
            else if(event.keyCode == 38 && d != "DOWN") d = "UP";
            else if(event.keyCode == 39 && d != "LEFT") d = "RIGHT";
            else if(event.keyCode == 40 && d != "UP") d = "DOWN";
        }
        
        function changeDirection(dir) {
            if(dir == "LEFT" && d != "RIGHT") d = "LEFT";
            else if(dir == "UP" && d != "DOWN") d = "UP";
            else if(dir == "RIGHT" && d != "LEFT") d = "RIGHT";
            else if(dir == "DOWN" && d != "UP") d = "DOWN";
        }

        function draw() {
            // Background
            ctx.fillStyle = "#080808";
            ctx.fillRect(0, 0, canvasSize, canvasSize);

            // Grid (Subtle)
            ctx.strokeStyle = "#111";
            ctx.lineWidth = 1;
            for(let i=0; i<canvasSize; i+=box) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,canvasSize); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvasSize,i); ctx.stroke();
            }

            // Draw Snake
            for(let i = 0; i < snake.length; i++) {
                // Style: Gradient Head, Blue Body
                let color = (i == 0) ? "#00ff88" : "#00a3ff";
                
                ctx.fillStyle = color;
                // Shadow for glow
                ctx.shadowBlur = (i==0) ? 20 : 5;
                ctx.shadowColor = color;
                
                // Rounded segments
                let x = snake[i].x;
                let y = snake[i].y;
                
                // Draw Body Segment (Slightly smaller than box for segment effect)
                ctx.beginPath();
                ctx.roundRect(x + 1, y + 1, box - 2, box - 2, 5); 
                ctx.fill();
                
                // Draw Eyes on Head
                if (i == 0) {
                    ctx.fillStyle = "black";
                    ctx.shadowBlur = 0; // No glow for eyes
                    
                    if (d == "RIGHT") {
                        ctx.fillRect(x + 12, y + 4, 4, 4); // Top Eye
                        ctx.fillRect(x + 12, y + 12, 4, 4); // Bottom Eye
                    } else if (d == "LEFT") {
                        ctx.fillRect(x + 4, y + 4, 4, 4);
                        ctx.fillRect(x + 4, y + 12, 4, 4);
                    } else if (d == "UP") {
                        ctx.fillRect(x + 4, y + 4, 4, 4);
                        ctx.fillRect(x + 12, y + 4, 4, 4);
                    } else if (d == "DOWN") {
                        ctx.fillRect(x + 4, y + 12, 4, 4);
                        ctx.fillRect(x + 12, y + 12, 4, 4);
                    }
                }
            }
            
            ctx.shadowBlur = 0; // Reset

            // Draw Food (Pulsing)
            foodPulse += 0.2;
            let pulseSize = (Math.sin(foodPulse) * 2) + (box/2.5);
            
            ctx.fillStyle = "#ff4b4b";
            ctx.shadowBlur = 20;
            ctx.shadowColor = "#ff4b4b";
            ctx.beginPath();
            ctx.arc(food.x + box/2, food.y + box/2, pulseSize, 0, Math.PI*2);
            ctx.fill();
            ctx.shadowBlur = 0;

            // Logic
            let snakeX = snake[0].x;
            let snakeY = snake[0].y;

            if(d == "LEFT") snakeX -= box;
            if(d == "UP") snakeY -= box;
            if(d == "RIGHT") snakeX += box;
            if(d == "DOWN") snakeY += box;

            // Eat
            if(snakeX == food.x && snakeY == food.y) {
                score++;
                playSound('eat');
                speak("eat");
                document.getElementById('score').innerText = score;
                food = {
                    x: Math.floor(Math.random() * 19) * box,
                    y: Math.floor(Math.random() * 19) * box
                }
            } else {
                snake.pop();
            }

            let newHead = { x: snakeX, y: snakeY };

            if(snakeX < 0 || snakeX >= canvasSize || snakeY < 0 || snakeY >= canvasSize || collision(newHead, snake)) {
                clearInterval(game);
                isGameRunning = false;
                playSound('die');
                speak("die");
                
                // Draw Dead Eyes
                ctx.strokeStyle = "white";
                ctx.lineWidth = 2;
                ctx.beginPath(); ctx.moveTo(snake[0].x+4, snake[0].y+4); ctx.lineTo(snake[0].x+16, snake[0].y+16); ctx.stroke();
                ctx.beginPath(); ctx.moveTo(snake[0].x+16, snake[0].y+4); ctx.lineTo(snake[0].x+4, snake[0].y+16); ctx.stroke();

                if(score > highScore) {
                    highScore = score;
                    localStorage.setItem('snakeHighScore', highScore);
                    document.getElementById('high-score').innerText = highScore;
                    speak("highScore");
                }
                return;
            }

            snake.unshift(newHead);
        }

        function collision(head, array) {
            for(let i = 0; i < array.length; i++) {
                if(head.x == array[i].x && head.y == array[i].y) {
                    return true;
                }
            }
            return false;
        }

        function resetGame() {
            if(isGameRunning) clearInterval(game);
            
            // Get selected speed
            const speedVal = document.getElementById('speedSelect').value;
            
            snake = [];
            snake[0] = { x: 9 * box, y: 10 * box };
            
            food = {
                x: Math.floor(Math.random() * 19) * box,
                y: Math.floor(Math.random() * 19) * box
            };
            
            score = 0;
            d = null; // Wait for input
            document.getElementById('score').innerText = 0;
            speak("start");
            
            game = setInterval(draw, parseInt(speedVal));
            isGameRunning = true;
        }

        // Draw Start Screen
        ctx.fillStyle = "#080808";
        ctx.fillRect(0, 0, canvasSize, canvasSize);
        ctx.fillStyle = "#00ff88";
        ctx.font = "20px Orbitron";
        ctx.fillText("PRESS START", 120, 200);

    </script>
</body>
</html>
